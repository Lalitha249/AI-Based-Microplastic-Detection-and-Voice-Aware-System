import matplotlib.pyplot as plt
from tensorflow.keras.preprocessing.image import ImageDataGenerator
def get_data_generators(train_dir, test_dir, img_height, img_width, batch_size): train_datagen = ImageDataGenerator(
rescale=1./255, rotation_range=20, zoom_range=0.2, horizontal_flip=True, validation_split=0.2
)
train_gen = train_datagen.flow_from_directory( train_dir,
target_size=(img_height, img_width), batch_size=batch_size, class_mode='binary',
subset='training'
)
val_gen = train_datagen.flow_from_directory( train_dir,
target_size=(img_height, img_width), batch_size=batch_size, class_mode='binary', subset='validation'
)
test_datagen = ImageDataGenerator(rescale=1./255) test_gen = test_datagen.flow_from_directory(
test_dir,
target_size=(img_height, img_width), batch_size=batch_size, class_mode='binary',
shuffle=False
)
return train_gen, val_gen, test_gen
